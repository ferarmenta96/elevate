// ── CONFIGURACIÓN ──────────────────────────────────────────
var ADMIN_EMAIL = "tu-email@empresa.com"; // ← Cambia por tu email
// ───────────────────────────────────────────────────────────

function doPost(e) {
  if (!e.postData) return ContentService.createTextOutput("No data");

  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Contactos");
  const data  = JSON.parse(e.postData.contents);

  sheet.appendRow([
    new Date(),
    data.fullName || "",
    data.company  || "",
    data.email    || "",
    data.phone    || "",
    data.revenue  || "",
    data.message  || ""
  ]);

  return ContentService.createTextOutput("Success").setMimeType(ContentService.MimeType.TEXT);
}

function doGet(e) {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName("Contactos");
  const data  = sheet.getDataRange().getValues();
  return ContentService
    .createTextOutput(JSON.stringify(data))
    .setMimeType(ContentService.MimeType.JSON);
}

function testScript() {
  var fakeEvent = {
    postData: {
      contents: JSON.stringify({
        fullName : "Carlos Méndez",
        company  : "Meridian Corp",
        email    : "carlos@meridian.com",
        phone    : "+1 555 123 4567",
        revenue  : "$10M – $50M",
        message  : "Quiero automatizar mis ventas."
      })
    }
  };
  doPost(fakeEvent);
  Logger.log("✅ Listo - revisa tu Google Sheet");
}
